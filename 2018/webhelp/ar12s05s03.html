
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xhtml="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Performance</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.2" /><link rel="home" href="oxygen-main.html" title="Markup UK 2018 Proceedings" /><link rel="up" href="ar12s05.html" title="Results" /><link rel="prev" href="ar12s05s02.html" title="Usability" /><link rel="next" href="ar12s06.html" title="Conclusions" /><!--  Generated with Oxygen version 20.0-SNAPSHOT, build number 2018032809.  --><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><script type="text/javascript" xml:space="preserve"><!--
          
          var prefix = "index.html";
          
          --></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery-3.1.1.min.js" xml:space="preserve"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.cookie.js" xml:space="preserve"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.highlight-3.js" xml:space="preserve"><!----></script><script type="text/javascript" charset="utf-8" src="oxygen-webhelp/resources/js/webhelp_topic.js?buildId=2018032809" xml:space="preserve"><!----></script></head><body onload="highlightSearchTerm()" class="frmBody"><div class="navheader"><table width="100%" summary="Navigation header"><tr><td colspan="3" rowspan="1"><form name="searchForm" id="searchForm" action="javascript:void(0)" onsubmit="parent.tocwin.SearchToc(this);" method="get" enctype="application/x-www-form-urlencoded"><!----><input type="text" id="textToSearch" name="textToSearch" class="textToSearch" size="30" placeholder="Search" /><!----></form></td></tr><tr><td width="20%" align="left" rowspan="1" colspan="1"><span class="navprev"><a accesskey="p" href="ar12s05s02.html" shape="rect">Prev</a></span> </td><th width="60%" align="center" rowspan="1" colspan="1"> </th><td width="20%" align="right" rowspan="1" colspan="1"> <span class="navnext"><a accesskey="n" href="ar12s06.html" shape="rect">Next</a></span></td></tr></table><hr /></div><div class="sect2" id="d5e5313"><div class="titlepage"><div><div><h3 class="title">Performance</h3></div></div></div><p>No serious work on optimizing (or measuring) performance has yet been done. However, it's useful to get some very
            preliminary data to assess whether performance is going to be a major obstacle to the feasibility of the approach.</p><p>I constructed a valid data file containing ten thousand book elements.</p><p>With the existing Saxon-EE schema validator, validation took 1.1 seconds.</p><p>With the XSLT validator, validation (using Saxon-EE on Java as the XSLT engine) took 9.4 seconds.</p><p>This represents a ballpark estimate of the relative efficiency. It's not a thorough benchmark in any way; there is no point in doing
            a thorough benchmark until some basic performance tuning has been done.</p><p>There are clearly many opportunities for performance improvement. Some of the obvious inefficiencies, relative to the Java
            validator, include:</p><div xmlns:svg="http://www.w3.org/2000/svg" class="itemizedlist"><ul class="itemizedlist" style=""><li class="listitem"><p>In evaluating items with a pattern facet, the regular expression is recompiled every time an item is validated.
                    This is because the <code class="code">fn:matches()</code> function precompiles the regular expression if it is known statically, but
                    it makes no attempt to cache the compiled regular expression if the same regex is used repeatedly. The regex in this case is
                    read from the SCM file at run-time, so no compile-time optimization is possible.</p></li><li class="listitem"><p>Similarly, XPath expressions used in assertions may be recompiled every time they are used. There are some
                    circumstances in which <code class="code">xsl:evaluate</code> will cache compiled XPath expressions that are used repeatedly, but
                    this doesn't appear to be happening in this stylesheet.</p></li><li class="listitem"><p>Too much data is being retained from validation and passed upwards from the validation of a child to the validation
                    of its parent. This results in bloated maps containing validation outcomes, that take a long time to combine.
                    It's probably not difficult to find "low-hanging" optimizations in this area.</p></li></ul></div><p>It's clear that a lot of the time is being spent creating and combining the maps that are used to pass data up the tree.
                The whole application relies very heavily on maps, and its performance depends on the performance of map operations
                such as <code class="code">map:put</code> and <code class="code">map:merge</code>. It's possible that it might benefit from a different implementation
                of maps that is tailored to the usage patterns that occur when map types are declared as tuple types. It could also
                benefit from changes to the application to make more selective use of maps. In particular, we seem to be incurring heavy costs
                inspecting and copying maps that are actually empty, because all the data is valid: there's clearly an opportunity for optimizations
                here.</p><p>For the moment, all we can conclude about performance is that more work needs to be done. Making the XSLT validator as fast
            as the existing Java validator is probably unachievable, but we should be able to get acceptably close.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left" rowspan="1" colspan="1"><span class="navprev"><a accesskey="p" href="ar12s05s02.html" shape="rect">Prev</a></span> </td><td width="20%" align="center" rowspan="1" colspan="1"><a accesskey="u" href="ar12s05.html" shape="rect">Up</a></td><td width="40%" align="right" rowspan="1" colspan="1"> <span class="navnext"><a accesskey="n" href="ar12s06.html" shape="rect">Next</a></span></td></tr><tr><td width="40%" align="left" valign="top" rowspan="1" colspan="1"> </td><td width="20%" align="center" rowspan="1" colspan="1"><a accesskey="h" href="oxygen-main.html" shape="rect">Home</a></td><td width="40%" align="right" valign="top" rowspan="1" colspan="1"> </td></tr></table></div><div class="footer">Generated by<a class="oxyFooter" href="http://www.oxygenxml.com/xml_webhelp.html" target="_blank" shape="rect">                            
                            &lt;oXygen/&gt; XML WebHelp
                        </a></div></body></html>