
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xhtml="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Evaluating schema components</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.2" /><link rel="home" href="oxygen-main.html" title="Markup UK 2023 Proceedings" /><link rel="up" href="ar11s07.html" title="Other features" /><link rel="prev" href="userDefinedFunctions.html" title="User-defined functions" /><link rel="next" href="ar11s07s03.html" title="Maps, arrays and anonymous functions as variables" /><!--  Generated with Oxygen version 24.0, build number 2021121511.  --><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><script type="text/javascript" xml:space="preserve"><!--
          
          var prefix = "index.html";
          
          --></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery-3.5.1.min.js" xml:space="preserve"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.cookie.js" xml:space="preserve"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.highlight-3.js" xml:space="preserve"><!----></script><script type="text/javascript" charset="utf-8" src="oxygen-webhelp/resources/js/webhelp_topic.js?buildId=2021121511" xml:space="preserve"><!----></script></head><body onload="highlightSearchTerm()" class="frmBody"><div class="navheader"><table width="100%" summary="Navigation header"><tr><td colspan="3" rowspan="1"><form name="searchForm" id="searchForm" action="javascript:void(0)" onsubmit="parent.tocwin.SearchToc(this);" method="get" enctype="application/x-www-form-urlencoded"><!----><input type="text" id="textToSearch" name="textToSearch" class="textToSearch" size="30" placeholder="Search" /><!----></form></td></tr><tr><td width="20%" align="left" rowspan="1" colspan="1"><span class="navprev"><a accesskey="p" href="userDefinedFunctions.html" shape="rect">Prev</a></span> </td><th width="60%" align="center" rowspan="1" colspan="1"> </th><td width="20%" align="right" rowspan="1" colspan="1"> <span class="navnext"><a accesskey="n" href="ar11s07s03.html" shape="rect">Next</a></span></td></tr></table><hr /></div><div class="section" id="programmaticAssembly"><div class="titlepage"><div><div><h3 class="title">Evaluating schema components</h3></div></div></div><p>The API of the evaluation module contains discrete functions for schema, patterns, rules and assertions. This means that a complete schema is not required in order to perform evaluation of these components in isolation. One possible and likely application of this technique would be unit testing. The following is an example taken from the XQS test suite itself:</p><pre class="programlisting" xml:space="preserve">(:~ active pattern processed :)
declare %unit:test function _:process-pattern()
{
  let $result := <span class="bold"><strong>eval:pattern</strong></span>(
    <strong class="hl-tag" style="color: #000096">&lt;sch:pattern</strong> <span class="hl-attribute" style="color: #F5844C">id</span>=<span class="hl-value" style="color: #993300">'e'</span> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">'f'</span> <span class="hl-attribute" style="color: #F5844C">role</span>=<span class="hl-value" style="color: #993300">'g'</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
      <strong class="hl-tag" style="color: #000096">&lt;sch:rule</strong> <span class="hl-attribute" style="color: #F5844C">context</span>=<span class="hl-value" style="color: #993300">'*'</span> <span class="hl-attribute" style="color: #F5844C">id</span>=<span class="hl-value" style="color: #993300">'a'</span> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">'b'</span> <span class="hl-attribute" style="color: #F5844C">role</span>=<span class="hl-value" style="color: #993300">'c'</span> <span class="hl-attribute" style="color: #F5844C">flag</span>=<span class="hl-value" style="color: #993300">'d'</span><strong class="hl-tag" style="color: #000096">/&gt;</strong>
    <strong class="hl-tag" style="color: #000096">&lt;/sch:pattern&gt;</strong>,
    map{'instance':document{<strong class="hl-tag" style="color: #000096">&lt;foo/&gt;</strong>}, 'globals':map{}}
  )
  return unit:assert-equals(
    $result,
    (<strong class="hl-tag" style="color: #000096">&lt;svrl:active-pattern</strong> <span class="hl-attribute" style="color: #F5844C">id</span>=<span class="hl-value" style="color: #993300">'e'</span> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">'f'</span> <span class="hl-attribute" style="color: #F5844C">role</span>=<span class="hl-value" style="color: #993300">'g'</span><strong class="hl-tag" style="color: #000096">/&gt;</strong>,
    <strong class="hl-tag" style="color: #000096">&lt;svrl:fired-rule</strong> <span class="hl-attribute" style="color: #F5844C">context</span>=<span class="hl-value" style="color: #993300">'*'</span> <span class="hl-attribute" style="color: #F5844C">id</span>=<span class="hl-value" style="color: #993300">'a'</span> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">'b'</span> <span class="hl-attribute" style="color: #F5844C">role</span>=<span class="hl-value" style="color: #993300">'c'</span> <span class="hl-attribute" style="color: #F5844C">flag</span>=<span class="hl-value" style="color: #993300">'d'</span><strong class="hl-tag" style="color: #000096">/&gt;</strong>)
  )
};</pre><p>Here, the call to <code class="literal">eval:pattern()</code> (shown in bold) evaluates the <code class="sgmltag-element">pattern</code> passed in against the context provided by the second, map argument. In this instance, the unit test is to check that patterns and rules are reported correctly in SVRL, but the user can extend this approach elsewhere via calls to <code class="literal">eval:rule()</code> and <code class="literal">eval:assertion()</code>; further examples of this appear in the XQS test suite.<a href="#ftn.d5e3561" class="footnote" shape="rect"><sup class="footnote" id="d5e3561">[43]</sup></a></p><div class="footnotes"><br clear="none" /><hr style="width:100; text-align:left;margin-left: 0" /><div id="ftn.d5e3561" class="footnote"><p><a href="#d5e3561" class="para" shape="rect"><sup class="para">[43] </sup></a><a class="link" href="https://github.com/AndrewSales/XQS/tree/main/test" target="_top" shape="rect">https://github.com/AndrewSales/XQS/tree/main/test</a></p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left" rowspan="1" colspan="1"><span class="navprev"><a accesskey="p" href="userDefinedFunctions.html" shape="rect">Prev</a></span> </td><td width="20%" align="center" rowspan="1" colspan="1"><a accesskey="u" href="ar11s07.html" shape="rect">Up</a></td><td width="40%" align="right" rowspan="1" colspan="1"> <span class="navnext"><a accesskey="n" href="ar11s07s03.html" shape="rect">Next</a></span></td></tr><tr><td width="40%" align="left" valign="top" rowspan="1" colspan="1"> </td><td width="20%" align="center" rowspan="1" colspan="1"><a accesskey="h" href="oxygen-main.html" shape="rect">Home</a></td><td width="40%" align="right" valign="top" rowspan="1" colspan="1"> </td></tr></table></div><div class="footer">Generated by<a class="oxyFooter" href="http://www.oxygenxml.com/xml_webhelp.html" target="_blank" shape="rect">                            
                            &lt;oXygen/&gt; XML WebHelp
                        </a></div></body></html>