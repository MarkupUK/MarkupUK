
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xhtml="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>An advanced example</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.2" /><link rel="home" href="oxygen-main.html" title="Markup UK 2023 Proceedings" /><link rel="up" href="ar13.html" title="A Dependency Management Approach for Document and Data Transformation Projects" /><link rel="prev" href="ar13s12.html" title="A step further" /><link rel="next" href="ar13s14.html" title="Conclusions" /><!--  Generated with Oxygen version 24.0, build number 2021121511.  --><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><script type="text/javascript" xml:space="preserve"><!--
          
          var prefix = "index.html";
          
          --></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery-3.5.1.min.js" xml:space="preserve"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.cookie.js" xml:space="preserve"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.highlight-3.js" xml:space="preserve"><!----></script><script type="text/javascript" charset="utf-8" src="oxygen-webhelp/resources/js/webhelp_topic.js?buildId=2021121511" xml:space="preserve"><!----></script></head><body onload="highlightSearchTerm()" class="frmBody"><div class="navheader"><table width="100%" summary="Navigation header"><tr><td colspan="3" rowspan="1"><form name="searchForm" id="searchForm" action="javascript:void(0)" onsubmit="parent.tocwin.SearchToc(this);" method="get" enctype="application/x-www-form-urlencoded"><!----><input type="text" id="textToSearch" name="textToSearch" class="textToSearch" size="30" placeholder="Search" /><!----></form></td></tr><tr><td width="20%" align="left" rowspan="1" colspan="1"><span class="navprev"><a accesskey="p" href="ar13s12.html" shape="rect">Prev</a></span> </td><th width="60%" align="center" rowspan="1" colspan="1"> </th><td width="20%" align="right" rowspan="1" colspan="1"> <span class="navnext"><a accesskey="n" href="ar13s14.html" shape="rect">Next</a></span></td></tr></table><hr /></div><div class="section" id="d5e3903"><div class="titlepage"><div><div><h2 class="title" style="clear: both">An advanced example</h2></div></div></div><p> You may probably be willing to have a simple dependency declaration directly on the Xslts
      and Xprocs. We didn’t choose that approach because that means that we would have to declare
      every small dependency between each file. That would also exclude from the artifacts graphic
      or web resources, specially the binary ones.</p><p>If you have a very specific context where you work mainly with Xslts and Xprocs we could
      adjust the solution to manage dependencies directly.</p><p>In the advanced-configuration example we have added two projects, one that publishes an
      xslt and other that depends on it. We have added a namespace alias (“arimp”) to identify the
      dependency declarations in both xslts. The “build-tasks-report.xsl” has an element that
      indicates that the xslt should be published. </p><pre class="programlisting" xml:space="preserve"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<strong class="hl-tag" style="color: #000096">&lt;xsl:stylesheet</strong>
    <span class="hl-attribute" style="color: #F5844C">version</span>=<span class="hl-value" style="color: #993300">"3.0"</span> 
    <span class="hl-attribute" style="color: #F5844C">xmlns:xsl</span>=<span class="hl-value" style="color: #993300">"http://www.w3.org/1999/XSL/Transform"</span> 
    <span class="hl-attribute" style="color: #F5844C">xmlns:xsi</span>=<span class="hl-value" style="color: #993300">"http://www.w3.org/2001/XMLSchema-instance"</span> 
    <span class="hl-attribute" style="color: #F5844C">xmlns:xsd</span>=<span class="hl-value" style="color: #993300">"http://www.w3.org/2001/XMLSchema"</span>
  <span class="hl-attribute" style="color: #F5844C">xmlns:arimp</span>=<span class="hl-value" style="color: #993300">"http://www.vionta.net/schemas/arousa-import/
                                      v1.0/arousa-import.xsd"</span>
    <span class="hl-attribute" style="color: #F5844C">exclude-result-prefixes</span>=<span class="hl-value" style="color: #993300">"arimp"</span><strong class="hl-tag" style="color: #000096">
&gt;</strong>
 <span class="bold"><strong>&lt;arimp:publication artifact-name="build-tasks-report"   /&gt;</strong></span>
  <strong class="hl-tag" style="color: #000096">&lt;xsl:template</strong> <span class="hl-attribute" style="color: #F5844C">match</span>=<span class="hl-value" style="color: #993300">"/"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
...</pre><p>On the target project the actual report file has a similar declaration indicating the
      dependency.</p><pre class="programlisting" xml:space="preserve"><strong class="hl-tag" style="color: #000096">&lt;xsl:stylesheet</strong>
    <span class="hl-attribute" style="color: #F5844C">version</span>=<span class="hl-value" style="color: #993300">"3.0"</span> 
    <span class="hl-attribute" style="color: #F5844C">xmlns:xsl</span>=<span class="hl-value" style="color: #993300">"http://www.w3.org/1999/XSL/Transform"</span> 
    <span class="hl-attribute" style="color: #F5844C">xmlns:xsi</span>=<span class="hl-value" style="color: #993300">"http://www.w3.org/2001/XMLSchema-instance"</span> 
    <span class="hl-attribute" style="color: #F5844C">xmlns:xsd</span>=<span class="hl-value" style="color: #993300">"http://www.w3.org/2001/XMLSchema"</span>
    <span class="hl-attribute" style="color: #F5844C">xmlns:arimp</span>=<span class="hl-value" style="color: #993300">"http://www.vionta.net/schemas/arousa-import/
                                      v1.0/arousa-import.xsd"</span>
    <span class="hl-attribute" style="color: #F5844C">exclude-result-prefixes</span>=<span class="hl-value" style="color: #993300">"arimp"</span><strong class="hl-tag" style="color: #000096">
    &gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;arimp:dependency</strong>
      <span class="hl-attribute" style="color: #F5844C">component</span>=<span class="hl-value" style="color: #993300">"lineal-fods"</span> <span class="hl-attribute" style="color: #F5844C">org</span>=<span class="hl-value" style="color: #993300">"net.vionta.
                                  transformation.spreadsheet"</span>
      <span class="hl-attribute" style="color: #F5844C">rev</span>=<span class="hl-value" style="color: #993300">"1.0"</span> <span class="hl-attribute" style="color: #F5844C">artifact</span>=<span class="hl-value" style="color: #993300">"build-tasks-report"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;xsl:template</strong> <span class="hl-attribute" style="color: #F5844C">match</span>=<span class="hl-value" style="color: #993300">"/"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
...</pre><p> Both projects are Xproc capable and include an xproc on the conf folder called
      generate-ivy-dependency-file.xpl. </p><pre class="programlisting" xml:space="preserve"><strong class="hl-tag" style="color: #000096">&lt;p:declare-step</strong> 
    <span class="hl-attribute" style="color: #F5844C">xmlns:p</span>=<span class="hl-value" style="color: #993300">"http://www.w3.org/ns/xproc"</span>  
    <span class="hl-attribute" style="color: #F5844C">version</span>=<span class="hl-value" style="color: #993300">"3.0"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>

 <strong class="hl-tag" style="color: #000096">&lt;p:input</strong> <span class="hl-attribute" style="color: #F5844C">port</span>=<span class="hl-value" style="color: #993300">"source"</span> <span class="hl-attribute" style="color: #F5844C">primary</span>=<span class="hl-value" style="color: #993300">"true"</span><strong class="hl-tag" style="color: #000096"> &gt;</strong> <strong class="hl-tag" style="color: #000096">&lt;p:inline&gt;</strong> <strong class="hl-tag" style="color: #000096">&lt;documento/&gt;</strong> 
                                          <strong class="hl-tag" style="color: #000096">&lt;/p:inline&gt;</strong> <strong class="hl-tag" style="color: #000096">&lt;/p:input&gt;</strong>
 <strong class="hl-tag" style="color: #000096">&lt;p:output</strong> <span class="hl-attribute" style="color: #F5844C">port</span>=<span class="hl-value" style="color: #993300">"result"</span> <span class="hl-attribute" style="color: #F5844C">primary</span>=<span class="hl-value" style="color: #993300">"true"</span> <span class="hl-attribute" style="color: #F5844C">pipe</span>=<span class="hl-value" style="color: #993300">"result@final-list"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
 <strong class="hl-tag" style="color: #000096">&lt;p:load</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"load-ivy-file"</span><strong class="hl-tag" style="color: #000096">  &gt;</strong>
   <strong class="hl-tag" style="color: #000096">&lt;p:with-option</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"href"</span> <span class="hl-attribute" style="color: #F5844C">select</span>=<span class="hl-value" style="color: #993300">"'./arousa-ivy.xml'"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
 <strong class="hl-tag" style="color: #000096">&lt;/p:load&gt;</strong>
 <strong class="hl-tag" style="color: #000096">&lt;p:directory-list</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"xslt-directory-list"</span>
       <span class="hl-attribute" style="color: #F5844C">include-filter</span>=<span class="hl-value" style="color: #993300">".xsl"</span>  <span class="hl-attribute" style="color: #F5844C">exclude-filter</span>=<span class="hl-value" style="color: #993300">".xsl~"</span><strong class="hl-tag" style="color: #000096"> &gt;</strong>
   <strong class="hl-tag" style="color: #000096">&lt;p:with-option</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"path"</span> <span class="hl-attribute" style="color: #F5844C">select</span>=<span class="hl-value" style="color: #993300">"'../src/xsl/'"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
 <strong class="hl-tag" style="color: #000096">&lt;/p:directory-list&gt;</strong>

 <strong class="hl-tag" style="color: #000096">&lt;p:for-each</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"xsl-files"</span><strong class="hl-tag" style="color: #000096"> &gt;</strong>
   <strong class="hl-tag" style="color: #000096">&lt;p:with-input</strong> <span class="hl-attribute" style="color: #F5844C">select</span>=<span class="hl-value" style="color: #993300">"//*:file[@*:name]"</span><strong class="hl-tag" style="color: #000096">  /&gt;</strong>
   <strong class="hl-tag" style="color: #000096">&lt;p:load</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"load-file-content"</span><strong class="hl-tag" style="color: #000096">  &gt;</strong>
     <strong class="hl-tag" style="color: #000096">&lt;p:with-option</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"href"</span> 
          <span class="hl-attribute" style="color: #F5844C">select</span>=<span class="hl-value" style="color: #993300">"concat('../src/xsl/', .//@*:name)"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
   <strong class="hl-tag" style="color: #000096">&lt;/p:load&gt;</strong>
 <strong class="hl-tag" style="color: #000096">&lt;/p:for-each&gt;</strong>
 <strong class="hl-tag" style="color: #000096">&lt;p:wrap-sequence</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"xslt-imports"</span> <span class="hl-attribute" style="color: #F5844C">wrapper</span>=<span class="hl-value" style="color: #993300">"xsl-files"</span><strong class="hl-tag" style="color: #000096"> &gt;</strong>
 <strong class="hl-tag" style="color: #000096">&lt;/p:wrap-sequence&gt;</strong>
 <strong class="hl-tag" style="color: #000096">&lt;p:insert</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"merge"</span> <span class="hl-attribute" style="color: #F5844C">position</span>=<span class="hl-value" style="color: #993300">"first-child"</span><strong class="hl-tag" style="color: #000096"> &gt;</strong>
   <strong class="hl-tag" style="color: #000096">&lt;p:with-input</strong> <span class="hl-attribute" style="color: #F5844C">port</span>=<span class="hl-value" style="color: #993300">"insertion"</span>  <span class="hl-attribute" style="color: #F5844C">pipe</span>=<span class="hl-value" style="color: #993300">"result@load-ivy-file"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
 <strong class="hl-tag" style="color: #000096">&lt;/p:insert&gt;</strong>
  
  <strong class="hl-tag" style="color: #000096">&lt;p:xslt</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"final-list"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>  
      <strong class="hl-tag" style="color: #000096">&lt;p:with-input</strong> <span class="hl-attribute" style="color: #F5844C">port</span>=<span class="hl-value" style="color: #993300">"stylesheet"</span> 
            <span class="hl-attribute" style="color: #F5844C">href</span>=<span class="hl-value" style="color: #993300">"./extract-import-elements.xsl"</span><strong class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;/p:xslt&gt;</strong>

   <strong class="hl-tag" style="color: #000096">&lt;p:store</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"final-serialization"</span><strong class="hl-tag" style="color: #000096"> &gt;</strong>
     <strong class="hl-tag" style="color: #000096">&lt;p:with-option</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"href"</span> <span class="hl-attribute" style="color: #F5844C">select</span>=<span class="hl-value" style="color: #993300">"'./arousa-ivy.xml'"</span><strong class="hl-tag" style="color: #000096"> /&gt;</strong>
   <strong class="hl-tag" style="color: #000096">&lt;/p:store&gt;</strong>
 <strong class="hl-tag" style="color: #000096">&lt;/p:declare-step&gt;</strong></pre><p> As you can see, the Xproc lists the xslts from the src/xsl folder and wraps them with the
      current arousa-ivy file. The xslt merges the organization and configuration options from the
      existing ivy file with the imports extracted from the xslts.</p><p> As a result, the script populates the Ivy dependency file with the dependency relations. </p><pre class="programlisting" xml:space="preserve"><span class="hl-directive" style="color: maroon">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<strong class="hl-tag" style="color: #000096">&lt;ivy-module</strong> <span class="hl-attribute" style="color: #F5844C">version</span>=<span class="hl-value" style="color: #993300">"1.1"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
 <strong class="hl-tag" style="color: #000096">&lt;info</strong> <span class="hl-attribute" style="color: #F5844C">organisation</span>=<span class="hl-value" style="color: #993300">"org.markupuk.examples.arousa"</span>
       <span class="hl-attribute" style="color: #F5844C">module</span>=<span class="hl-value" style="color: #993300">"sample-fods-report"</span><strong class="hl-tag" style="color: #000096">/&gt;</strong>
  <strong class="hl-tag" style="color: #000096">&lt;dependencies</strong> <span class="hl-attribute" style="color: #F5844C">defaultconf</span>=<span class="hl-value" style="color: #993300">"default"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
      <strong class="hl-tag" style="color: #000096">&lt;dependency</strong> <span class="hl-attribute" style="color: #F5844C">org</span>=<span class="hl-value" style="color: #993300">"net.vionta.transformation.spreadsheet"</span>
                  <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"lineal-fods"</span> <span class="hl-attribute" style="color: #F5844C">rev</span>=<span class="hl-value" style="color: #993300">"1.0"</span><strong class="hl-tag" style="color: #000096">&gt;</strong>
         <strong class="hl-tag" style="color: #000096">&lt;artifact</strong> <span class="hl-attribute" style="color: #F5844C">name</span>=<span class="hl-value" style="color: #993300">"build-tasks-report"</span>
                   <span class="hl-attribute" style="color: #F5844C">type</span>=<span class="hl-value" style="color: #993300">"transformation"</span> <span class="hl-attribute" style="color: #F5844C">ext</span>=<span class="hl-value" style="color: #993300">"xsl"</span><strong class="hl-tag" style="color: #000096">/&gt;</strong>
      <strong class="hl-tag" style="color: #000096">&lt;/dependency&gt;</strong>
   <strong class="hl-tag" style="color: #000096">&lt;/dependencies&gt;</strong>
<strong class="hl-tag" style="color: #000096">&lt;/ivy-module&gt;</strong></pre><p> Both the xsl publishing and retrieval works with the same commands as the rest of
      examples (publish-dependency and update-dependencies). </p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left" rowspan="1" colspan="1"><span class="navprev"><a accesskey="p" href="ar13s12.html" shape="rect">Prev</a></span> </td><td width="20%" align="center" rowspan="1" colspan="1"><a accesskey="u" href="ar13.html" shape="rect">Up</a></td><td width="40%" align="right" rowspan="1" colspan="1"> <span class="navnext"><a accesskey="n" href="ar13s14.html" shape="rect">Next</a></span></td></tr><tr><td width="40%" align="left" valign="top" rowspan="1" colspan="1"> </td><td width="20%" align="center" rowspan="1" colspan="1"><a accesskey="h" href="oxygen-main.html" shape="rect">Home</a></td><td width="40%" align="right" valign="top" rowspan="1" colspan="1"> </td></tr></table></div><div class="footer">Generated by<a class="oxyFooter" href="http://www.oxygenxml.com/xml_webhelp.html" target="_blank" shape="rect">                            
                            &lt;oXygen/&gt; XML WebHelp
                        </a></div></body></html>