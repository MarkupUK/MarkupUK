
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xhtml="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>What testing revealed</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.2" /><link rel="home" href="oxygen-main.html" title="Markup UK 2025 Proceedings" /><link rel="up" href="testing-ixml.html" title="Testing an iXML grammar" /><link rel="prev" href="xspec-for-ixml.html" title="Using XSpec to test iXML" /><link rel="next" href="automation.html" title="Automation" /><!--  Generated with Oxygen version 24.0, build number 2022011710.  --><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><script type="text/javascript" xml:space="preserve"><!--
          
          var prefix = "index.html";
          
          --></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery-3.5.1.min.js" xml:space="preserve"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.cookie.js" xml:space="preserve"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.highlight-3.js" xml:space="preserve"><!----></script><script type="text/javascript" charset="utf-8" src="oxygen-webhelp/resources/js/webhelp_topic.js?buildId=2022011710" xml:space="preserve"><!----></script></head><body onload="highlightSearchTerm()" class="frmBody"><div class="navheader"><table width="100%" summary="Navigation header"><tr><td colspan="3" rowspan="1"><form name="searchForm" id="searchForm" action="javascript:void(0)" onsubmit="parent.tocwin.SearchToc(this);" method="get" enctype="application/x-www-form-urlencoded"><!----><input type="text" id="textToSearch" name="textToSearch" class="textToSearch" size="30" placeholder="Search" /><!----></form></td></tr><tr><td width="20%" align="left" rowspan="1" colspan="1"><span class="navprev"><a accesskey="p" href="xspec-for-ixml.html" shape="rect">Prev</a></span> </td><th width="60%" align="center" rowspan="1" colspan="1"> </th><td width="20%" align="right" rowspan="1" colspan="1"> <span class="navnext"><a accesskey="n" href="automation.html" shape="rect">Next</a></span></td></tr></table><hr /></div><div class="section" id="revelations"><div class="titlepage"><div><div><h3 class="title">What testing revealed</h3></div></div></div><p>Initially, the errors were caused by a fairly equal mix of syntax errors in my grammar, eg. forgetting to add a full-stop at the end of each rule, and incomplete grammar rules. On the syntax errors front, I resolved this with a more throrough reading of the iXML spec and comparing other iXML grammars with each other, as well as my own. The incomplete grammar rules were inevitable as I was testing it before it was complete.</p><p>Whitespace was a problem.  Michael Sperberg-McQueen wrote about this in 2023, in his paper on <em class="citetitle">Keyboarding Frege's concept writing</em>[<a class="citation" href="references.html#d5e828" shape="rect"><span class="citation">CMS2023</span></a>]:</p><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top" rowspan="1" colspan="1"> </td><td width="80%" valign="top" rowspan="1" colspan="1"><p>The handling of whitespace is one of the trickiest and least expected problems confronted by the writer of invisible-XML grammars. Even those with long experience using and writing context-free grammars may be tripped up by it, partly because most practical tools for parser generation assume an upstream lexical analyser or tokenizer which can handle whitespace rules, and most published context-free grammars accordingly omit all mention of whitespace. Because ixml does not assume any upstream lexical analyser, whitespace must be handled by the grammar writer.</p><p>If care is not taken, then either whitespace will not be allowed in places where it should be allowed, or it will be allowed by multiple rules, introducing ambiguity into the grammar. (In this case, the ambiguity is usually harmless, since the position of whitespace seldom affects the intended meaning of the input. But there is no way for the parser to know when ambiguity is harmless, so it will warn the user.) On the other hand, if care is taken, then whitespace handling can begin to consume all too much of the grammar writer’s thoughts.</p></td><td width="10%" valign="top" rowspan="1" colspan="1"> </td></tr><tr><td width="10%" valign="top" rowspan="1" colspan="1"> </td><td colspan="2" align="right" valign="top" rowspan="1">--<span class="attribution">Michael Sperberg-McQueen</span></td></tr></table></div><p>That was exactly my experience: finding that whitespace wasn't allowed where it should and then was allowed where it shouldn't. Similarly, before I started writing the grammar, I hadn't really thought about the source including content I might want to drop, for example, delimiters and other punctuation. However, with each new scenario I discovered, I was able to create a new test and if the fix for this new problem unintentionally broke a scenario that was previously working, I knew about it straight away.</p><p>Another white-space challenge was understanding what <code class="code">Zs</code> is shorthand for. Although it is referenced in the iXML grammar, it's not also defined there, unlike <code class="code">tab</code>, <code class="code">lf</code> and <code class="code">cr</code> which are all defined as well as referenced (see <a class="xref" href="revelations.html#ixml-whitespace-rules" title="Figure 10. iXML definition of whitespace, including Zs" shape="rect">Figure 10, “iXML definition of whitespace, including Zs”</a>.</p><div class="figure" id="ixml-whitespace-rules"><p class="title"><strong>Figure 10. iXML definition of whitespace, including Zs</strong></p><div class="figure-contents"><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="200"><tr><td rowspan="1" colspan="1"><img src="papers-2025/02-thomson/images/ixml_whitespace_definition.png" width="200" alt="iXML definition of whitespace, including Zs" /></td></tr></table></div></div></div><br class="figure-break" clear="none" /><p>However, the iXML specification mentions Unicode character classes and, sure enough, <code class="code">Zs</code> is defined in <em class="citetitle">Table 4.4</em> of the <em class="citetitle">Character Properties</em> chapter of the core specification of the Unicode Standard[<a class="citation" href="references.html#d5e833" shape="rect"><span class="citation">UNIGEN</span></a>] (see figure 11). This isn’t the only Unicode character class code that’s used in the iXML spec so, unless you’re familiar with them all, you may also find this table useful.</p><div class="figure" id="unicode-general-category"><p class="title"><strong>Figure 11. Excerpt from the Unicode Standard showing the definition of Zs</strong></p><div class="figure-contents"><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td rowspan="1" colspan="1"><img src="papers-2025/02-thomson/images/unicode_general_characters.png" width="100%" alt="Excerpt from the Unicode Standard showing the definition of Zs" /></td></tr></table></div></div></div><br class="figure-break" clear="none" /><p>As I got towards the end of writing my grammar and I started to try to make sure that it exactly implemented the rules for a DOCTYPE declaration, as defined for XML 1.0 (fifth edition)[<a class="citation" href="references.html#d5e773" shape="rect"><span class="citation">XML1-0</span></a>] and 1.1[<a class="citation" href="references.html#d5e840" shape="rect"><span class="citation">XML1-1</span></a>] (the rules are the same in both specs).</p><div class="figure" id="xml-doctypedecl-definition"><p class="title"><strong>Figure 12. Excerpts from the XML 1.0 Specification showing the rules for a DOCTYPE declaration</strong></p><div class="figure-contents"><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td rowspan="1" colspan="1"><img src="papers-2025/02-thomson/images/xml_doctypedecl.png" width="100%" alt="Excerpts from the XML 1.0 Specification showing the rules for a DOCTYPE declaration" /></td></tr></table></div></div></div><br class="figure-break" clear="none" /><p>I copied the character ranges from the XML spec and pasted them into my iXML grammar but when I tested the changes, an error was thrown, complaining that character <code class="code">#EFFFF</code> wasn’t allowed. A quick search revealed that <code class="code">#EFFFF</code> is one of 66 Unicode code points confusingly labelled <span class="emphasis"><em>Noncharacter</em></span>[<a class="citation" href="references.html#d5e845" shape="rect"><span class="citation">WIKINON</span></a>][<a class="citation" href="references.html#d5e851" shape="rect"><span class="citation">UNINON</span></a>][<a class="citation" href="references.html#d5e833" shape="rect"><span class="citation">UNIGEN</span></a>]. This prompted me to post a question in the <em class="citetitle">xml.com</em> space on <a class="link" href="https://slack.com" target="_top" shape="rect">Slack.com</a>. The conversation this triggered is now lost because messages in that Space are hidden after 90 days (I should have, instead, emailed the question to the iXML mailing list where the discussion would have been preserved) however the kind people of XML Slack helped me understand that:</p><div xmlns:svg="http://www.w3.org/2000/svg" class="itemizedlist"><ul class="itemizedlist" style=""><li class="listitem"><p>the problematic character was in the rule for a Name Start Character</p></li><li class="listitem"><p>the iXML definition for a Name Start Character isn't the same as the XML definition for Name Start Character</p></li></ul></div><p>This isn't the only difference between iXML and XML when it comes to names and the archive for the iXML mailing list includes quite a long discussion about this[<a class="citation" href="references.html#d5e856" shape="rect"><span class="citation">CHARDISCUSS</span></a>]. Norm Tovey-Walsh has also investigated the differences and documented his detailed findings and some history in <em class="citetitle">Understanding (i)XML names</em>[<a class="citation" href="references.html#d5e861" shape="rect"><span class="citation">IXMLNAMES</span></a>]. My temporary workaround was to fallback to using the more restrictive iXML definition: <code class="code">-xml-name-start-character: ["_"; L].</code></p><p>Another whitespace-related challenge manifested when I configured CoffeePot to pretty print the XML output and XSpec started failing my tests because of whitespace differences. I had already updated the expected result so that it was also pretty printed and the actual result looked identical in the side-by-side diff but on closer examination I discovered that CoffeePot was indenting with spaces, whereas I had used tabs to indent the expected result. The samples are much easier to work with if pretty printed, so I didn’t want to remove the indentation but as I believe that tabs are superior to spaces (#religious-war), I wasn’t about to change the settings in my text editor to replace tabs with spaces and the odds were low that I would remember to use spaces instead of tabs in just those files. Instead, I created an XSLT identity transform that strips whitespace and added it to my XSpec file as a helper.</p><p>The final noteworthy test failure was also XSpec related. Both <code class="code">x:context</code> and <code class="code">x:expect</code> were set to source their content from external files (<code class="code">@href</code>), with no <code class="code">select</code> attribute. And it looked as though the result matched the expected, but the tests were failing because the result was an <code class="code">element()</code> but expected was a <code class="code">document-node()</code>. My workaround for this was to set each of the expects to select the root <code class="code">element()</code>, instead of the <code class="code">document-node()</code>.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left" rowspan="1" colspan="1"><span class="navprev"><a accesskey="p" href="xspec-for-ixml.html" shape="rect">Prev</a></span> </td><td width="20%" align="center" rowspan="1" colspan="1"><a accesskey="u" href="testing-ixml.html" shape="rect">Up</a></td><td width="40%" align="right" rowspan="1" colspan="1"> <span class="navnext"><a accesskey="n" href="automation.html" shape="rect">Next</a></span></td></tr><tr><td width="40%" align="left" valign="top" rowspan="1" colspan="1"> </td><td width="20%" align="center" rowspan="1" colspan="1"><a accesskey="h" href="oxygen-main.html" shape="rect">Home</a></td><td width="40%" align="right" valign="top" rowspan="1" colspan="1"> </td></tr></table></div><div class="footer">Generated by<a class="oxyFooter" href="http://www.oxygenxml.com/xml_webhelp.html" target="_blank" shape="rect">                            
                            &lt;oXygen/&gt; XML WebHelp
                        </a></div></body></html>