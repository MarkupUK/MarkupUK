
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xhtml="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Typed data</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.2" /><link rel="home" href="oxygen-main.html" title="Markup UK 2018 Proceedings" /><link rel="up" href="ar12s03.html" title="Design Considerations" /><link rel="prev" href="ar12s03s03.html" title="Streaming" /><link rel="next" href="ar12s03s05.html" title="Support for xsi:schemaLocation" /><!--  Generated with Oxygen version 20.0-SNAPSHOT, build number 2018042310.  --><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><script type="text/javascript" xml:space="preserve"><!--
          
          var prefix = "index.html";
          
          --></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery-3.1.1.min.js" xml:space="preserve"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.cookie.js" xml:space="preserve"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.highlight-3.js" xml:space="preserve"><!----></script><script type="text/javascript" charset="utf-8" src="oxygen-webhelp/resources/js/webhelp_topic.js?buildId=2018042310" xml:space="preserve"><!----></script></head><body onload="highlightSearchTerm()" class="frmBody"><div class="navheader"><table width="100%" summary="Navigation header"><tr><td colspan="3" rowspan="1"><form name="searchForm" id="searchForm" action="javascript:void(0)" onsubmit="parent.tocwin.SearchToc(this);" method="get" enctype="application/x-www-form-urlencoded"><!----><input type="text" id="textToSearch" name="textToSearch" class="textToSearch" size="30" placeholder="Search" /><!----></form></td></tr><tr><td width="20%" align="left" rowspan="1" colspan="1"><span class="navprev"><a accesskey="p" href="ar12s03s03.html" shape="rect">Prev</a></span> </td><th width="60%" align="center" rowspan="1" colspan="1"> </th><td width="20%" align="right" rowspan="1" colspan="1"> <span class="navnext"><a accesskey="n" href="ar12s03s05.html" shape="rect">Next</a></span></td></tr></table><hr /></div><div class="sect2" id="d5e5107"><div class="titlepage"><div><div><h3 class="title">Typed data</h3></div></div></div><p>We have already mentioned that XSLT 3.0 can only generate a typed result tree (specifically, a node with non-trivial type annotations)
            by invoking a schema validator to produce the type annotations, and this precludes the possibility of writing that schema validator
            in XSLT 3.0. So the first obvious restriction we have to live with is that our validator will only do that part of the job concerned
            with detecting invalidity, not the other part concerned with augmenting the supplied instance with type information.</p><p>Unfortunately, even the task of distinguishing valid from invalid documents requires some use of type information associated
            with nodes. The most obvious example is that assertions (XPath expressions in <code class="code">xsd:assert</code> declarations) are defined
            to operate on "semi-typed" data - that is data that has been validated using all the constraints in the schema other than assertions,
            and typed accordingly. For example, if <code class="code">@price</code> and <code class="code">@discount</code> are attributes of type <code class="code">xs:decimal</code>,
            then the assertion <code class="code">test="@discount lt @price"</code> is defined to do a decimal comparison, not a string comparison.</p><p>We don't currently have a solution to this problem. We found, however, that very few schemas are affected. With such schemas,
                it is currently necessary to rewrite the assertion to do explicit typing: in this case 
                <code class="code">test="xs:decimal(@discount) lt xs:decimal(@price)"</code></p><p>Another case where typed data can be important is in <code class="code">key</code> and <code class="code">keyref</code> constraints. For example,
            if a uniqueness constraint applies to an attribute <code class="code">@birthDate</code> of type <code class="code">xs:date</code>, then values of that
            attribute are compared as dates, not as strings. Again, we found that this is rarely a problem in practice, but in this case
            we do have a solution that covers most cases: by doing static analysis of the XPath expressions used in the <code class="code">selector</code>
            and <code class="code">field</code> elements of the constraint, we can usually determine the data type of the values these expressions are
            selecting, and we can put this inferred type into the SCM and use it to cast the values before comparison. The only case where
            this approach proves inadequate are pathological cases where the type cannot be statically inferred, for example when the XPath
            expressions use union types or wildcards.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left" rowspan="1" colspan="1"><span class="navprev"><a accesskey="p" href="ar12s03s03.html" shape="rect">Prev</a></span> </td><td width="20%" align="center" rowspan="1" colspan="1"><a accesskey="u" href="ar12s03.html" shape="rect">Up</a></td><td width="40%" align="right" rowspan="1" colspan="1"> <span class="navnext"><a accesskey="n" href="ar12s03s05.html" shape="rect">Next</a></span></td></tr><tr><td width="40%" align="left" valign="top" rowspan="1" colspan="1"> </td><td width="20%" align="center" rowspan="1" colspan="1"><a accesskey="h" href="oxygen-main.html" shape="rect">Home</a></td><td width="40%" align="right" valign="top" rowspan="1" colspan="1"> </td></tr></table></div><div class="footer">Generated by<a class="oxyFooter" href="http://www.oxygenxml.com/xml_webhelp.html" target="_blank" shape="rect">                            
                            &lt;oXygen/&gt; XML WebHelp
                        </a></div></body></html>