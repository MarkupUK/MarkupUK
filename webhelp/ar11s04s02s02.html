
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xhtml="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Transformation</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.2" /><link rel="home" href="oxygen-main.html" title="Markup UK 2019 Proceedings" /><link rel="up" href="ar11s04s02.html" title="Execution steps" /><link rel="prev" href="ar11s04s02s01.html" title="Export" /><link rel="next" href="ar11s04s02s03.html" title="Aggregation" /><!--  Generated with Oxygen version 21.0, build number 2019032613.  --><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><script type="text/javascript" xml:space="preserve"><!--
          
          var prefix = "index.html";
          
          --></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery-3.1.1.min.js" xml:space="preserve"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.cookie.js" xml:space="preserve"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.highlight-3.js" xml:space="preserve"><!----></script><script type="text/javascript" charset="utf-8" src="oxygen-webhelp/resources/js/webhelp_topic.js?buildId=2019032613" xml:space="preserve"><!----></script></head><body onload="highlightSearchTerm()" class="frmBody"><div class="navheader"><table width="100%" summary="Navigation header"><tr><td colspan="3" rowspan="1"><form name="searchForm" id="searchForm" action="javascript:void(0)" onsubmit="parent.tocwin.SearchToc(this);" method="get" enctype="application/x-www-form-urlencoded"><!----><input type="text" id="textToSearch" name="textToSearch" class="textToSearch" size="30" placeholder="Search" /><!----></form></td></tr><tr><td width="20%" align="left" rowspan="1" colspan="1"><span class="navprev"><a accesskey="p" href="ar11s04s02s01.html" shape="rect">Prev</a></span> </td><th width="60%" align="center" rowspan="1" colspan="1"> </th><td width="20%" align="right" rowspan="1" colspan="1"> <span class="navnext"><a accesskey="n" href="ar11s04s02s03.html" shape="rect">Next</a></span></td></tr></table><hr /></div><div class="sect3" id="d5e5510"><div class="titlepage"><div><div><h4 class="title">Transformation</h4></div></div></div><div class="sect4" id="d5e5512"><div class="titlepage"><div><div><h5 class="title">XML serialization</h5></div></div></div><p>Serialization of any data into XML has its challenges. First of all,
                        DBUnit has to figure out the type of the data field. Is it:</p><div xmlns:svg="http://www.w3.org/2000/svg" class="itemizedlist"><ul class="itemizedlist" style=""><li class="listitem"><p>text</p></li><li class="listitem"><p>numeric</p></li><li class="listitem"><p>binary</p></li></ul></div><p>If it's binary, then it gets embedded into XML as a Base64 encoded string.
                        All the 64 characters this encoding uses are valid XML characters.</p><p>Serializing numeric values is easy. However, text data can contain
                        characters which are invalid in XML. For example, some legacy applications
                        used "<span class="emphasis"><em>control characters</em></span>" - below decimal 32 (space
                        char). Most of those are invalid in XML 1.0. XML 1.1 expands the set of
                        allowed characters.</p><p>Of course, we could work around this by Base64 encoding all textual data,
                        but this would result in cumbersome processes when we query the data.</p><p>In projects, we did stick with XML 1.0, and when we faced illegal XML
                        characters in the DBUnit output, mostly we could simply remove them safely
                        with a low level (text) process.</p></div><div class="sect4" id="d5e5527"><div class="titlepage"><div><div><h5 class="title">Data types</h5></div></div></div><p>Getting the data types converted correctly is a challenging part of the
                        process. SQL implementations bring vendor-specific data types. All of them
                        have to be mapped accurately to XML schema data types. This is done via
                        configuration.</p></div><div class="sect4" id="d5e5530"><div class="titlepage"><div><div><h5 class="title">Row customizer</h5></div></div></div><p>In our framework, we tried to implement the process to be as generic as
                        possible, but we also added customization options.</p><p>Our row customizer is a custom XQuery that gets a single row as input and
                        can filter or modify it.</p></div><div class="sect4" id="d5e5534"><div class="titlepage"><div><div><h5 class="title">Format conversion</h5></div></div></div><p>The serialization format DBUnit uses is not the best when we want to query
                        the data set. It's worth to write generic code to turn XML with column names
                        as text, into XML with column names used as element names.</p><div class="example" id="d5e5537"><p class="title"><strong>Example 5. XML data using the relational model - better semantics:</strong></p><div class="example-contents"><pre class="programlisting" xml:space="preserve">
&lt;employee&gt;
    &lt;row&gt;
        &lt;employee-id&gt;e1&lt;/employee-id&gt;
        &lt;first-name&gt;Ola&lt;/first-name&gt;
        &lt;second-name&gt;Nordmann&lt;/second-name&gt;
    &lt;/row&gt;
&lt;/employee&gt;</pre></div></div><br class="example-break" clear="none" /></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left" rowspan="1" colspan="1"><span class="navprev"><a accesskey="p" href="ar11s04s02s01.html" shape="rect">Prev</a></span> </td><td width="20%" align="center" rowspan="1" colspan="1"><a accesskey="u" href="ar11s04s02.html" shape="rect">Up</a></td><td width="40%" align="right" rowspan="1" colspan="1"> <span class="navnext"><a accesskey="n" href="ar11s04s02s03.html" shape="rect">Next</a></span></td></tr><tr><td width="40%" align="left" valign="top" rowspan="1" colspan="1"> </td><td width="20%" align="center" rowspan="1" colspan="1"><a accesskey="h" href="oxygen-main.html" shape="rect">Home</a></td><td width="40%" align="right" valign="top" rowspan="1" colspan="1"> </td></tr></table></div><div class="footer">Generated by<a class="oxyFooter" href="http://www.oxygenxml.com/xml_webhelp.html" target="_blank" shape="rect">                            
                            &lt;oXygen/&gt; XML WebHelp
                        </a></div></body></html>