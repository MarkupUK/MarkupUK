
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xhtml="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Overall Design</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.2" /><link rel="home" href="oxygen-main.html" title="Markup UK 2019 Proceedings" /><link rel="up" href="ar08.html" title="&lt;Angle-brackets/&gt; on the Branch Line" /><link rel="prev" href="ar08s01.html" title="Introduction" /><link rel="next" href="ar08s03.html" title="Layout Topology and Geometry" /><!--  Generated with Oxygen version 21.0, build number 2019032613.  --><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><script type="text/javascript" xml:space="preserve"><!--
          
          var prefix = "index.html";
          
          --></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery-3.1.1.min.js" xml:space="preserve"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.cookie.js" xml:space="preserve"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.highlight-3.js" xml:space="preserve"><!----></script><script type="text/javascript" charset="utf-8" src="oxygen-webhelp/resources/js/webhelp_topic.js?buildId=2019032613" xml:space="preserve"><!----></script></head><body onload="highlightSearchTerm()" class="frmBody"><div class="navheader"><table width="100%" summary="Navigation header"><tr><td colspan="3" rowspan="1"><form name="searchForm" id="searchForm" action="javascript:void(0)" onsubmit="parent.tocwin.SearchToc(this);" method="get" enctype="application/x-www-form-urlencoded"><!----><input type="text" id="textToSearch" name="textToSearch" class="textToSearch" size="30" placeholder="Search" /><!----></form></td></tr><tr><td width="20%" align="left" rowspan="1" colspan="1"><span class="navprev"><a accesskey="p" href="ar08s01.html" shape="rect">Prev</a></span> </td><th width="60%" align="center" rowspan="1" colspan="1"> </th><td width="20%" align="right" rowspan="1" colspan="1"> <span class="navnext"><a accesskey="n" href="ar08s03.html" shape="rect">Next</a></span></td></tr></table><hr /></div><div class="sect1" id="d5e3506"><div class="titlepage"><div><div><h2 class="title" style="clear: both">Overall Design</h2></div></div></div><p>The system designed is of course influenced by the external factors of the garden itself and the track components from which the railway
            will be built. The garden area chosen is approximately 10m x 4m on two levels: </p><div class="figure" id="d5e3509"><p class="title"><strong>Figure 1. The Garden for the Railway</strong></p><div class="figure-contents"><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td rowspan="1" colspan="1"><img src="papers-2019/john/figures/survey.JPG" width="100%" alt="The Garden for the Railway" /></td></tr></table></div></div></div><br class="figure-break" clear="none" /><p>Both levels are substantially flat<a href="#ftn.d5e3515" class="footnote" shape="rect"><sup class="footnote" id="d5e3515">[12]</sup></a> with a step of about 250mm between, so it should be possible to climb a connecting embankment. (Generally gradients should be
            less than 1 in 40 and certainly no more than 1 in 25). The area was surveyed (marked by the red survey points shown above) and a
            simplified plan of the garden drawn up:</p><div class="figure" id="d5e3517"><p class="title"><strong>Figure 2. The garden plan</strong></p><div class="figure-contents"><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="100%"><tr><td rowspan="1" colspan="1"><img src="papers-2019/john/figures/Plan.PNG" width="100%" alt="The garden plan" /></td></tr></table></div></div></div><br class="figure-break" clear="none" /><p>I decided that the railway would be built at SM32 gauge/scale, also known as 16mm. The track has a gauge of 32mm, and is taken to
            represent a 2ft narrow-gauge line<a href="#ftn.d5e3523" class="footnote" shape="rect"><sup class="footnote" id="d5e3523">[13]</sup></a> so the scale is 16mm to the foot or 1:19. As such, models of narrow-gauge locomotives are large enough to be totally
            steam-powered. The tracks themselves would not carry electrical power — all engines would be self-powered, and remotely controlled. The
            commercially available track had a small set of points of different tightness and flexible track sections of some 900mm length. This meant
            that apart from the fixed-design points, the rest of the track could be <span class="quote">“<span class="quote">freeform</span>”</span>, subject of course to a recommended
            minimum turn radius, which whilst being dependent upon locomotive wheelbase, would be about 900-1000 mm.</p><p>The original design consists of five major sections:</p><div xmlns:svg="http://www.w3.org/2000/svg" class="itemizedlist"><ul class="itemizedlist" style=""><li class="listitem"><p>A declarative description, as an XML structure, of the design environment, consisting of background components (e.g. pictures of
                    the garden and schematics of fixed sections such as walls, paving and plants) and a series of layouts. A layout is described as a
                    sequence of (mainline) track sections of straights, curves and points, each represented by an XML element describing length,
                    radius and/or turn angle. Branch lines are children sequences of a <code class="code">point</code> element. Where necessary track connections
                    between leaves of the tree are joined to make a complete graph thrrough named link declarations.</p></li><li class="listitem"><p>A geometry computational engine, written in XSLT3, which calculates the position and orientation of each track section, and
                    produces a map of the layout, keyed by section 'name', each entry describing both the track segments of the section and the
                    two-way connectivity between section ends. </p></li><li class="listitem"><p>A graphical display of the design as an SVG tree. Background elements are generated as SVG groups from the enviroment
                    description. Track components are generated from unit descriptions and positioned with <span class="emphasis"><em>use</em></span> instructions.
                    Within this, some components which can differ in display dependent upon state, such as points, are represented by several views,
                    each classed separately. The overall display can be subject to transform, most noteably an isometric one. Textural styling and
                    initial visibility is defined in a series of CSS stylesheets.</p></li><li class="listitem"><p>An XSLT3 stylesheet, using Saxon-JS extensions, and invoked from an outer XHTML document, which populates the XHTML with a
                    series of interactive controls, and generates the detailed layout internal structures and SVG graphics to be embedded in the web
                    page. Templates respond to interaction, such as button state changes, or clicking on points levers, altering the local CSS state
                    of other components and controls.
                    </p></li><li class="listitem"><p>Adding <span class="quote">“<span class="quote">railway engines</span>”</span> as SVG objects, which are presented in both plan and isometric views from a simple
                        <span class="quote">“<span class="quote">block-and-cylinder</span>”</span> model. An event-based system animates these to run along tangential paths of the track
                    sections, using SVG animation facilities. Speed and direction of travel can be controlled interactively for multiple engines.
                    Events are generated at the conclusion of animations, and are caught by templates that consult the layout map to determine the
                    next sector to enter, then calculate the necessary animation duration, given length and speed, and start up the path-following
                    animation. Speed change involves stopping a current animation, recalculating duration for the remaining section path and
                    restarting an new animation partway through. Issues on collision detection (<span class="quote">“<span class="quote">train crashes</span>”</span>) will be
                    discussed.</p></li></ul></div><p>As far as the software mix is concerned, the top-level XHTML document contains some constant background components and <code class="code">div</code>
            containers which will be populated, a <code class="code">script</code> element containing a very small set of global JavaScript functions, for primary
            control of animations and mapping from screen to SVG co-ordinates, and an invocation of Saxon-JS with a precompiled program from an XSLT
            source of some 20 files and perhaps some 3000 source lines. This program takes as input a file containingg definitions of the garden,
            possible layouts and locomotives. Textural styling is supported by a set of associated (static) CSS files.</p><p>There are a number of (Javascript) libraries for supporting SVG effects and animation, and pretty much all the written guides to
                <span class="quote">“<span class="quote">advanced</span>”</span> SVG use a combination of some of these, but I wanted to explore how much could be done almost entirely in
            XSLT3.0. All the programming is limited to XDM data types, XHTML, SVG, CSS and XSLT3.0 with Saxon-JS interaction extensions, with a
            minimum of (perhaps a dozen) globally defined small JavaScript functions, mostly to invoke,query and stop SVG animations.</p><div class="footnotes"><br clear="none" /><hr style="width:100; text-align:left;margin-left: 0" /><div id="ftn.d5e3515" class="footnote"><p><a href="#d5e3515" class="para" shape="rect"><sup class="para">[12] </sup></a>Only when laying out the track bed did it become apparent that several elevation changes O(50mm) existed on the upper
                    level.</p></div><div id="ftn.d5e3523" class="footnote"><p><a href="#d5e3523" class="para" shape="rect"><sup class="para">[13] </sup></a>Many of the UK's <span class="quote">“<span class="quote">little trains</span>”</span>, such as the Ffestiniog and the Talyllyn, run on 1' 11½" gauge track</p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left" rowspan="1" colspan="1"><span class="navprev"><a accesskey="p" href="ar08s01.html" shape="rect">Prev</a></span> </td><td width="20%" align="center" rowspan="1" colspan="1"><a accesskey="u" href="ar08.html" shape="rect">Up</a></td><td width="40%" align="right" rowspan="1" colspan="1"> <span class="navnext"><a accesskey="n" href="ar08s03.html" shape="rect">Next</a></span></td></tr><tr><td width="40%" align="left" valign="top" rowspan="1" colspan="1"> </td><td width="20%" align="center" rowspan="1" colspan="1"><a accesskey="h" href="oxygen-main.html" shape="rect">Home</a></td><td width="40%" align="right" valign="top" rowspan="1" colspan="1"> </td></tr></table></div><div class="footer">Generated by<a class="oxyFooter" href="http://www.oxygenxml.com/xml_webhelp.html" target="_blank" shape="rect">                            
                            &lt;oXygen/&gt; XML WebHelp
                        </a></div></body></html>